<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Failure Thresholds and How to Change Them • DataQualityDashboard</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Failure Thresholds and How to Change Them">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DataQualityDashboard</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.8.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../articles/DataQualityDashboard.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Thresholds.html">DQ Check Failure Thresholds</a>
    </li>
    <li>
      <a href="../articles/CheckStatusDefinitions.html">DQ Check Statuses</a>
    </li>
    <li>
      <a href="../articles/AddNewCheck.html">Adding a New Data Quality Check</a>
    </li>
    <li>
      <a href="../articles/DqdForCohorts.html">DQD for Cohorts</a>
    </li>
    <li>
      <a href="../articles/SqlOnly.html">SQL-only Mode</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Quality Check Types

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/checkIndex.html">Index</a>
    </li>
    <li>
      <a href="../articles/checks/cdmTable.html">cdmTable</a>
    </li>
    <li>
      <a href="../articles/checks/cdmField.html">cdmField</a>
    </li>
    <li>
      <a href="../articles/checks/cdmDatatype.html">cdmDatatype</a>
    </li>
    <li>
      <a href="../articles/checks/isPrimaryKey.html">isPrimaryKey</a>
    </li>
    <li>
      <a href="../articles/checks/isForeignKey.html">isForeignKey</a>
    </li>
    <li>
      <a href="../articles/checks/isRequired.html">isRequired</a>
    </li>
    <li>
      <a href="../articles/checks/fkDomain.html">fkDomain</a>
    </li>
    <li>
      <a href="../articles/checks/fkClass.html">fkClass</a>
    </li>
    <li>
      <a href="../articles/checks/measurePersonCompleteness.html">measurePersonCompleteness</a>
    </li>
    <li>
      <a href="../articles/checks/measureValueCompleteness.html">measureValueCompleteness</a>
    </li>
    <li>
      <a href="../articles/checks/isStandardValidConcept.html">isStandardValidConcept</a>
    </li>
    <li>
      <a href="../articles/checks/standardConceptRecordCompleteness.html">standardConceptRecordCompleteness</a>
    </li>
    <li>
      <a href="../articles/checks/sourceConceptRecordCompleteness.html">sourceConceptRecordCompleteness</a>
    </li>
    <li>
      <a href="../articles/checks/sourceValueCompleteness.html">sourceValueCompleteness</a>
    </li>
    <li>
      <a href="../articles/checks/plausibleAfterBirth.html">plausibleAfterBirth</a>
    </li>
    <li>
      <a href="../articles/checks/plausibleBeforeDeath.html">plausibleBeforeDeath</a>
    </li>
    <li>
      <a href="../articles/checks/plausibleStartBeforeEnd.html">plausibleStartBeforeEnd</a>
    </li>
    <li>
      <a href="../articles/checks/plausibleValueHigh.html">plausibleValueHigh</a>
    </li>
    <li>
      <a href="../articles/checks/plausibleValueLow.html">plausibleValueLow</a>
    </li>
    <li>
      <a href="../articles/checks/withinVisitDates.html">withinVisitDates</a>
    </li>
    <li>
      <a href="../articles/checks/measureConditionEraCompleteness.html">measureConditionEraCompleteness</a>
    </li>
    <li>
      <a href="../articles/checks/measureObservationPeriodOverlap.html">measureObservationPeriodOverlap</a>
    </li>
    <li>
      <a href="../articles/checks/plausibleUnitConceptIds.html">plausibleUnitConceptIds</a>
    </li>
    <li>
      <a href="../articles/checks/plausibleGenderUseDescendants.html">plausibleGenderUseDescendants</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://ohdsi.github.io/Hades" class="external-link"><img src='https://ohdsi.github.io/Hades/images/hadesMini.png' width=80 height=17 style='vertical-align: top;'></a>
</li>
<li>
  <a href="https://github.com/OHDSI/DataQualityDashboard/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Failure Thresholds and How to Change Them</h1>
                        <h4 data-toc-skip class="author">Clair
Blacketer</h4>
            
            <h4 data-toc-skip class="date">2025-09-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/DataQualityDashboard/blob/HEAD/vignettes/Thresholds.rmd" class="external-link"><code>vignettes/Thresholds.rmd</code></a></small>
      <div class="hidden name"><code>Thresholds.rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="dqd-failure-thresholds">DQD Failure Thresholds<a class="anchor" aria-label="anchor" href="#dqd-failure-thresholds"></a>
</h2>
<p>As described in the <a href="https://ohdsi.github.io/DataQualityDashboard/#introduction">introduction
to the tool</a>, the Data Quality Dashboard works by systematically
applying 20 data quality check types to a database by leveraging the
structure of the OMOP Common Data Model. This process results in over
3,300 potential data quality checks. These checks are then resolved
against the database, each one producing a number and percent of records
that fail. The percent failure is then compared against a number to
determine if the check itself should be marked as a pass or a fail
overall. Essentially, the threshold number is the percent of failed
records for a particular check you are willing to accept. If the percent
failures is lower than the threshold then it passes, otherwise the check
fails.</p>
<p>A default set of failure thresholds are shipped with the package.
Many of these are general thresholds determined by CDM experts and were
designed to test the minimum quality measures necessary to run an
analysis on a database. They do not take into account an apriori
knowledge of the database or data that is available. With that in mind,
it is possible to change the failure thresholds and even set different
thresholds for different databases.</p>
<div class="section level3">
<h3 id="dqd-control-files">DQD Control Files<a class="anchor" aria-label="anchor" href="#dqd-control-files"></a>
</h3>
<p>There is a set of three csv files that underlie the DQD. These files
indicate which checks should be run and what their failure thresholds
should be. There is one file per check level: TABLE, FIELD, and CONCEPT.
This vignette will walk through how to update the field level check
thresholds but the process is the same for all three files.</p>
<div class="section level4">
<h4 id="step-1-find-and-copy-the-control-files">Step 1: Find and copy the control files<a class="anchor" aria-label="anchor" href="#step-1-find-and-copy-the-control-files"></a>
</h4>
<p>The control files are located in the R package in the inst/csv folder
and can also be downloaded <a href="https://github.com/OHDSI/DataQualityDashboard/tree/master/inst/csv" class="external-link">here</a>.
In that location there should be four files per CDM version the DQD
supports. These are:</p>
<ul>
<li>
<strong>OMOP_CDMvx.x.x_Check_Descriptions.csv</strong>: This file
contains the check types, their descriptions, and which sql file is
associated with each. It does not contain any failure thresholds and
should not need to be changed.</li>
<li>
<strong>OMOP_CDMvx.x.x_Table_Level.csv</strong>: This file has a
list of all tables in the CDM version and any checks to be performed at
this level as well as the failure thresholds associated. Right now only
the checktype <a href="https://ohdsi.github.io/DataQualityDashboard/articles/CheckTypeDescriptions.html#measurepersoncompleteness">measurePersonCompleteness</a>
is considered a table level check. If you would like to change the
failure thresholds for the measurePersonCompleteness check copy this
file to a location the R instance can access.</li>
<li>
<strong>OMOP_CDMvx.x.x_Field_Level.csv</strong>: This file has a
list of all tables and fields in the CDM version and any checks to be
performed at this level as well as the failure thresholds associated.
The majority of the <a href="https://ohdsi.github.io/DataQualityDashboard/articles/CheckTypeDescriptions.html">check
types</a> run by the DQD are field level checks. If you would like to
change the failure thresholds for any of these checks copy this file to
a location the R instance can access. An example of this file is seen in
figure 1 below.</li>
</ul>
<div class="float">
<img src="images/fieldLevelFile.png" alt="Figure 1: Field Level Control File Example"><div class="figcaption">Figure 1: Field Level Control File Example</div>
</div>
<ul>
<li>
<strong>OMOP_CDMvx.x.x_Concept_Level.csv</strong>: This file has a
list of all concepts and any checks to be performed on that concept. For
example, there are checks that evaluate biologically plausible ranges
for measurement values, like <a href="https://ohdsi.github.io/DataQualityDashboard/articles/CheckTypeDescriptions.html#plausiblevaluelow-1">plausibleValueLow</a>.
If you would like to change the failure thresholds for any of these
checks copy this file to a location the R instance can access.</li>
</ul>
</div>
<div class="section level4">
<h4 id="step-2-turn-onoff-checks-and-change-thresholds">Step 2: Turn On/Off Checks and Change Thresholds<a class="anchor" aria-label="anchor" href="#step-2-turn-onoff-checks-and-change-thresholds"></a>
</h4>
<p>Using the field level file as an example, when you open it there will
be two columns listing the tables and fields in the OMOP CDM, as seen in
figure 1. Moving horizontally through the file there will be a column
named for each of the <a href="https://ohdsi.github.io/DataQualityDashboard/articles/CheckTypeDescriptions.html">check
types</a> available to run at the field level. At the intersection of
each check type and CDM field will be a cell with either a ‘Yes’ or ‘No’
value. A ‘Yes’ indicates that the check type will be run for that
specific table and field. For example in figure 1 there is a ‘Yes’ in
the <strong>isRequired</strong> column for the field
<strong>person_id</strong> in the <strong>PERSON</strong> table. This
means that the <a href="https://ohdsi.github.io/DataQualityDashboard/articles/CheckTypeDescriptions.html#isRequired"><strong>isRequired</strong></a>
check will be run, substituting <strong>person_id</strong> for
cdmFieldName and <strong>PERSON</strong> for cdmTableName.</p>
<p>So instead of the generic check type: <em>The number and percent of
records with a NULL value in the <strong>cdmFieldName</strong> of the
<strong>cdmTableName</strong> that is considered not nullable</em></p>
<p>The ‘Yes’ in cell C2 in figure 1 will resolve that check type to an
individual data quality check: <em>The number and percent of records
with a NULL value in the <strong>person_id</strong> of the
<strong>PERSON</strong> table that is considered not nullable</em></p>
<p>Using this method it is possible to turn checks on or off by changing
the ‘Yes’/‘No’ values in the control files. This will affect individual
checks only. If you would like to filter checks based on check level
(TABLE, FIELD, CONCEPT), check type (turn off all fkClass checks, for
example), or CDM table (turn off all checks for the COST table), this
can be done at the execution step and does not need to be specified in
the control file. The vignette <strong>Advanced DQD Execution
Options</strong> details how to do this.</p>
<p>For each check type column in the control file there will be one or
more additional columns based on the inputs the check type needs to
function. For instance the isForeignKey check has the fields fkTableName
and fkFieldName so that the check knows where to find the primary key
associated with the foreign key. Each check type will also have a column
named using the convention <strong>checktype</strong>Threshold. This is
the column that lists the threshold against which the check will be
evaluated to determine a pass or fail. Similarly to how the ‘Yes’/‘No’
indicators work, the intersection of each CDM field and check type
threshold field will hold a value that will be compared to the outcome
of the check to determine if the check passes or fails. In figure 1 for
the check that is turned on in cell C2 the threshold is listed in cell
D2. In this case the value is 0 indicating that if any records in the
database violate the rule then this check will fail.</p>
<p>To change the threshold for a check, input a value between 0 and 100.
The threshold value is based on the percent of records that violate a
check and indicates the percent of violating records you are willing to
tolerate. A 0 thresholds means that any violating records will cause the
check to fail and a 100 means that all records evaluated could violate
the check and the check will still pass. After changing any thresholds
in the control files, save the files in a location that the R instance
can access.</p>
</div>
<div class="section level4">
<h4 id="step-2a-documenting-metadata-on-updated-thresholds">Step 2a: Documenting Metadata on Updated Thresholds<a class="anchor" aria-label="anchor" href="#step-2a-documenting-metadata-on-updated-thresholds"></a>
</h4>
<p>In addition to thresholds, each check type will also have a column
named using the convention <strong>checktype</strong>Notes. These
columns allow entry of any information about why a particular check
threshold was changed for a certain database, or perhaps record a link
to an issue tracking system to denote that a failure has been identified
and a fix is in the works. If any notes are recorded these will be
exposed in the shiny application.</p>
</div>
<div class="section level4">
<h4 id="step-3-run-the-dqd-using-the-updated-thresholds">Step 3: Run the DQD Using the Updated Thresholds<a class="anchor" aria-label="anchor" href="#step-3-run-the-dqd-using-the-updated-thresholds"></a>
</h4>
<p>Follow the instructions on the <a href="https://ohdsi.github.io/DataQualityDashboard/articles/DataQualityDashboard.html">Getting
Started</a> page to set the parameters to run the Data Quality
Dashboard. When running the execute function, point the package to the
updated threshold files as shown in the example below. To do this, The
options <strong>tableCheckThresholdLoc</strong>,
<strong>fieldCheckThresholdLoc</strong>,
<strong>conceptCheckThresholdLoc</strong> should contain the fully
qualified location of the files. If you would like to revert to the
default thresholds these options can be removed from the execute
function call or be set to “default”.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>DataQualityDashboard<span class="sc">::</span><span class="fu">executeDqChecks</span>(<span class="at">connectionDetails =</span> connectionDetails, </span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>                                      <span class="at">cdmDatabaseSchema =</span> cdmDatabaseSchema, </span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>                                      <span class="at">resultsDatabaseSchema =</span> resultsDatabaseSchema,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>                                      <span class="at">cdmSourceName =</span> cdmSourceName, </span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>                                      <span class="at">numThreads =</span> numThreads,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>                                      <span class="at">sqlOnly =</span> sqlOnly, </span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>                                      <span class="at">outputFolder =</span> outputFolder, </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>                                      <span class="at">verboseMode =</span> verboseMode,</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>                                      <span class="at">writeToTable =</span> writeToTable,</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>                                      <span class="at">checkLevels =</span> checkLevels,</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>                                      <span class="at">tablesToExclude =</span> tablesToExclude,</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>                                      <span class="at">checkNames =</span> checkNames,</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>                                      <span class="at">tableCheckThresholdLoc =</span> location of the table check file,</span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>                                      <span class="at">fieldCheckThresholdLoc =</span> location of the field check file,</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a>                                      <span class="at">conceptCheckThresholdLoc =</span> location of the concept check file)</span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Katy Sadowski, Clair Blacketer, Maxim Moinat, Ajit Londhe, Anthony Sena, Anthony Molinaro, Frank DeFalco, Pavel Grafkin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
