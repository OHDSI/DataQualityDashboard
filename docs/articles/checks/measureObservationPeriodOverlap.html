<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>measureObservationPeriodOverlap • DataQualityDashboard</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../../bootstrap-toc.css">
<script src="../../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><meta property="og:title" content="measureObservationPeriodOverlap">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../../index.html">DataQualityDashboard</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../../articles/DataQualityDashboard.html">Get started</a>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/Thresholds.html">DQ Check Failure Thresholds</a>
    </li>
    <li>
      <a href="../../articles/CheckStatusDefinitions.html">DQ Check Statuses</a>
    </li>
    <li>
      <a href="../../articles/AddNewCheck.html">Adding a New Data Quality Check</a>
    </li>
    <li>
      <a href="../../articles/DqdForCohorts.html">DQD for Cohorts</a>
    </li>
    <li>
      <a href="../../articles/SqlOnly.html">SQL-only Mode</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Data Quality Check Types

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/checkIndex.html">Index</a>
    </li>
    <li>
      <a href="../../articles/checks/cdmTable.html">cdmTable</a>
    </li>
    <li>
      <a href="../../articles/checks/cdmField.html">cdmField</a>
    </li>
    <li>
      <a href="../../articles/checks/cdmDatatype.html">cdmDatatype</a>
    </li>
    <li>
      <a href="../../articles/checks/isPrimaryKey.html">isPrimaryKey</a>
    </li>
    <li>
      <a href="../../articles/checks/isForeignKey.html">isForeignKey</a>
    </li>
    <li>
      <a href="../../articles/checks/isRequired.html">isRequired</a>
    </li>
    <li>
      <a href="../../articles/checks/fkDomain.html">fkDomain</a>
    </li>
    <li>
      <a href="../../articles/checks/fkClass.html">fkClass</a>
    </li>
    <li>
      <a href="../../articles/checks/measurePersonCompleteness.html">measurePersonCompleteness</a>
    </li>
    <li>
      <a href="../../articles/checks/measureValueCompleteness.html">measureValueCompleteness</a>
    </li>
    <li>
      <a href="../../articles/checks/isStandardValidConcept.html">isStandardValidConcept</a>
    </li>
    <li>
      <a href="../../articles/checks/standardConceptRecordCompleteness.html">standardConceptRecordCompleteness</a>
    </li>
    <li>
      <a href="../../articles/checks/sourceConceptRecordCompleteness.html">sourceConceptRecordCompleteness</a>
    </li>
    <li>
      <a href="../../articles/checks/sourceValueCompleteness.html">sourceValueCompleteness</a>
    </li>
    <li>
      <a href="../../articles/checks/plausibleAfterBirth.html">plausibleAfterBirth</a>
    </li>
    <li>
      <a href="../../articles/checks/plausibleBeforeDeath.html">plausibleBeforeDeath</a>
    </li>
    <li>
      <a href="../../articles/checks/plausibleStartBeforeEnd.html">plausibleStartBeforeEnd</a>
    </li>
    <li>
      <a href="../../articles/checks/plausibleValueHigh.html">plausibleValueHigh</a>
    </li>
    <li>
      <a href="../../articles/checks/plausibleValueLow.html">plausibleValueLow</a>
    </li>
    <li>
      <a href="../../articles/checks/withinVisitDates.html">withinVisitDates</a>
    </li>
    <li>
      <a href="../../articles/checks/measureConditionEraCompleteness.html">measureConditionEraCompleteness</a>
    </li>
    <li>
      <a href="../../articles/checks/measureObservationPeriodOverlap.html">measureObservationPeriodOverlap</a>
    </li>
    <li>
      <a href="../../articles/checks/plausibleUnitConceptIds.html">plausibleUnitConceptIds</a>
    </li>
    <li>
      <a href="../../articles/checks/plausibleGenderUseDescendants.html">plausibleGenderUseDescendants</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://ohdsi.github.io/Hades" class="external-link"><img src='https://ohdsi.github.io/Hades/images/hadesMini.png' width=80 height=17 style='vertical-align: top;'></a>
</li>
<li>
  <a href="https://github.com/OHDSI/DataQualityDashboard/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>measureObservationPeriodOverlap</h1>
                        <h4 data-toc-skip class="author">Katy
Sadowski</h4>
            
            <h4 data-toc-skip class="date">2025-08-27</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/OHDSI/DataQualityDashboard/blob/HEAD/vignettes/checks/measureObservationPeriodOverlap.Rmd" class="external-link"><code>vignettes/checks/measureObservationPeriodOverlap.Rmd</code></a></small>
      <div class="hidden name"><code>measureObservationPeriodOverlap.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p><strong>Level</strong>: Table check<br><strong>Context</strong>: Verification<br><strong>Category</strong>: Plausibility<br><strong>Subcategory</strong>: Temporal<br><strong>Severity</strong>: Fatal 💀<br></p>
</div>
<div class="section level2">
<h2 id="description">Description<a class="anchor" aria-label="anchor" href="#description"></a>
</h2>
<p>The number and percent of persons that have overlapping or
back-to-back observation periods.</p>
</div>
<div class="section level2">
<h2 id="definition">Definition<a class="anchor" aria-label="anchor" href="#definition"></a>
</h2>
<p>This check verifies that observation periods for each person do not
overlap or have gaps of only one day between them. According to the OMOP
CDM specification, observation periods should not overlap or be
back-to-back to each other.</p>
<ul>
<li>
<em>Numerator</em>: The number of persons who have at least one pair
of overlapping or back-to-back observation periods</li>
<li>
<em>Denominator</em>: The total number of persons with observation
periods</li>
<li>
<em>Related CDM Convention(s)</em>: “Any two overlapping or adjacent
OBSERVATION_PERIOD records have to be merged into one” from <a href="https://ohdsi.github.io/CommonDataModel/cdm54.html#observation_period" class="external-link">CDM
specification</a>
</li>
<li>
<em>CDM Fields/Tables</em>: <code>OBSERVATION_PERIOD</code>
</li>
<li>
<em>Default Threshold Value</em>: 0%</li>
</ul>
</div>
<div class="section level2">
<h2 id="user-guidance">User Guidance<a class="anchor" aria-label="anchor" href="#user-guidance"></a>
</h2>
<p>A failure in this check indicates that there are persons in the
database who have overlapping or back-to-back observation periods, which
violates the OMOP CDM specification. Such observation periods will lead
to critical errors in analytics as all OHDSI tools assume that
observation periods do not overlap.</p>
<div class="section level3">
<h3 id="violated-rows-query">Violated rows query<a class="anchor" aria-label="anchor" href="#violated-rows-query"></a>
</h3>
<p>You may use the following SQL query to identify the specific persons
with overlapping observation periods:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode sql"><code class="sourceCode sql"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="kw">SELECT</span> <span class="kw">DISTINCT</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>    cdmTable.person_id,</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>    cdmTable.observation_period_start_date,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>    cdmTable.observation_period_end_date,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>    cdmTable2.observation_period_start_date <span class="kw">AS</span> overlap_start,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>    cdmTable2.observation_period_end_date <span class="kw">AS</span> overlap_end,</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>    <span class="cf">CASE</span> </span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>        <span class="cf">WHEN</span> cdmTable.observation_period_start_date <span class="op">&lt;=</span> cdmTable2.observation_period_end_date </span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>            <span class="kw">AND</span> cdmTable.observation_period_end_date <span class="op">&gt;=</span> cdmTable2.observation_period_start_date</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>        <span class="cf">THEN</span> <span class="st">'Overlapping'</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>        <span class="cf">WHEN</span> DATEADD(<span class="dt">day</span>, <span class="dv">1</span>, cdmTable.observation_period_end_date) <span class="op">=</span> cdmTable2.observation_period_start_date</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>            <span class="kw">OR</span> DATEADD(<span class="dt">day</span>, <span class="dv">1</span>, cdmTable2.observation_period_end_date) <span class="op">=</span> cdmTable.observation_period_start_date</span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>        <span class="cf">THEN</span> <span class="st">'Back-to-back'</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a>    <span class="cf">END</span> <span class="kw">AS</span> violation_type</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="kw">FROM</span> @cdmDatabaseSchema.observation_period cdmTable</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a><span class="kw">JOIN</span> @cdmDatabaseSchema.observation_period cdmTable2 </span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>    <span class="kw">ON</span> cdmTable.person_id <span class="op">=</span> cdmTable2.person_id</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>    <span class="kw">AND</span> cdmTable.observation_period_id <span class="op">!=</span> cdmTable2.observation_period_id</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a><span class="kw">WHERE</span> (cdmTable.observation_period_start_date <span class="op">&lt;=</span> cdmTable2.observation_period_end_date </span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>    <span class="kw">AND</span> cdmTable.observation_period_end_date <span class="op">&gt;=</span> cdmTable2.observation_period_start_date)</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>    <span class="kw">OR</span> (DATEADD(<span class="dt">day</span>, <span class="dv">1</span>, cdmTable.observation_period_end_date) <span class="op">=</span> cdmTable2.observation_period_start_date)</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>    <span class="kw">OR</span> (DATEADD(<span class="dt">day</span>, <span class="dv">1</span>, cdmTable2.observation_period_end_date) <span class="op">=</span> cdmTable.observation_period_start_date)</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> cdmTable.person_id, cdmTable.observation_period_start_date</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="etl-developers">ETL Developers<a class="anchor" aria-label="anchor" href="#etl-developers"></a>
</h3>
<p>If this check fails, you should investigate the root cause to
determine if the issue originates in the source data or if it is the
result of an ETL bug. Logic will need to be added to the ETL to
correctly merge overlapping or back-to-back periods of observed time,
and/or to handle bad data from the source. This is a fatal check and all
failures must be resolved before the CDM can be used.</p>
<p><strong>Examples of violations:</strong></p>
<ol style="list-style-type: decimal">
<li>
<strong>Overlapping periods</strong>:
<ul>
<li>Period 1: 2020-01-01 to 2020-06-30</li>
<li>Period 2: 2020-05-01 to 2020-12-31</li>
<li>These overlap from 2020-05-01 to 2020-06-30</li>
</ul>
</li>
<li>
<strong>Back-to-back periods</strong>:
<ul>
<li>Period 1: 2020-01-01 to 2020-06-30<br>
</li>
<li>Period 2: 2020-07-01 to 2020-12-31</li>
<li>These are back-to-back (one ends exactly one day before the other
starts)</li>
</ul>
</li>
</ol>
<p>Both scenarios should be merged into a single period from 2020-01-01
to 2020-12-31.</p>
</div>
<div class="section level3">
<h3 id="data-users">Data Users<a class="anchor" aria-label="anchor" href="#data-users"></a>
</h3>
<p>An OMOP CDM with overlapping or adjacent observation periods should
not be used. OHDSI tools assume that observation periods do not overlap,
and as such will return errors or incorrect results; for example, cohort
entry criteria and calculation of person-time will be executed
incorrectly.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Katy Sadowski, Clair Blacketer, Maxim Moinat, Ajit Londhe, Anthony Sena, Anthony Molinaro, Frank DeFalco, Pavel Grafkin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer>
</div>






  </body>
</html>
